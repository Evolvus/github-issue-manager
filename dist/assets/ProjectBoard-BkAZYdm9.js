import{c as N,j as e,C as h,a as b,b as w,I as y,d as j}from"./index-D9dTo_Rc.js";import{r as u}from"./react-vendor-Dku4jBrG.js";import{B as S}from"./badge-Dce5Ri_g.js";import{T as D}from"./TimeAgo-C9ktNgaz.js";import{F as L}from"./folder-kanban-DGVtio6P.js";import{D as k}from"./download-CDb-eUKk.js";import{S as I}from"./search-D7kZdEDu.js";const T=N("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);function B(c){const l=["Number","Title","URL","State","Repository","ProjectStatus","CreatedAt","ClosedAt"],i=c.map(s=>[s.number,'"'+(s.title||"").replace(/"/g,'""')+'"',s.url||"",s.state||"",s.repository?.nameWithOwner||s.repository||"",s.project_status||"",s.createdAt||"",s.closedAt||""]);return[l.join(","),...i.map(s=>s.join(","))].join(`
`)}function R(c,l){const i=B(c),s=new Blob([i],{type:"text/csv"}),p=URL.createObjectURL(s),m=document.createElement("a");m.href=p,m.download=l,m.click(),URL.revokeObjectURL(p)}function V({projects:c}){const[l,i]=u.useState(""),[s,p]=u.useState({}),[m,g]=u.useState({}),f=(t,n)=>{console.log(`Moving issue ${t} to status ${n}`)},v=t=>p(n=>({...n,[t]:!n[t]})),x=u.useMemo(()=>{if(!l)return[];const t=c.find(a=>a.id===l);if(!t)return[];const n=["Backlog","Ready","In progress","In review","Done"],d=new Map(n.map(a=>[a,[]]));for(const a of t.issues){const r=a.project_status||"Backlog";d.has(r)||d.set(r,[]),d.get(r).push({...a,project:t.title})}return n.map(a=>[a,d.get(a)||[]])},[l,c]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2 flex-wrap text-sm text-gray-600",children:[e.jsx(L,{className:"w-4 h-4"}),"Columns use the project field named ",e.jsx("code",{className:"px-1 bg-gray-100 rounded",children:"Status"}),e.jsxs("select",{value:l,onChange:t=>i(t.target.value),className:"border rounded-md text-sm px-2 py-1 ml-auto",children:[e.jsx("option",{value:"",children:"Select project"}),c.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})]}),e.jsxs("div",{className:"grid lg:grid-cols-5 md:grid-cols-3 sm:grid-cols-2 gap-4",children:[x.map(([t,n])=>{const d=m[t]||"",a=n.filter(r=>{const o=d.toLowerCase();return o?r.title&&r.title.toLowerCase().includes(o)||r.number.toString().includes(o)||(r.assignees||[]).some(C=>C.login.toLowerCase().includes(o)):!0});return e.jsxs(h,{className:"rounded-2xl",children:[e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:t}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{variant:"secondary",children:a.length}),e.jsx(k,{className:"w-4 h-4 cursor-pointer",onClick:()=>R(a,`${t}.csv`)}),e.jsx(T,{onClick:()=>v(t),className:`w-4 h-4 cursor-pointer transition-transform ${s[t]?"-rotate-90":""}`})]})]}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(I,{className:"w-4 h-4 absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx(y,{placeholder:"Search...",value:d,onChange:r=>g(o=>({...o,[t]:r.target.value})),className:"pl-7 h-8 text-sm"})]})]}),!s[t]&&e.jsx(j,{children:e.jsx("ul",{className:"space-y-3 max-h-[70vh] overflow-auto pr-1",onDragOver:r=>r.preventDefault(),onDrop:r=>{r.preventDefault();const o=JSON.parse(r.dataTransfer.getData("text/plain"));f(o.issueId,t)},children:a.map(r=>e.jsxs("li",{className:"p-3 border rounded-xl bg-white shadow-sm",draggable:!0,onDragStart:o=>o.dataTransfer.setData("text/plain",JSON.stringify({issueId:r.id})),children:[e.jsxs("a",{href:r.url,target:"_blank",rel:"noreferrer",className:"font-medium hover:underline block",children:["#",r.number," ",r.title]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.repository," â€¢ ",e.jsx(D,{iso:r.createdAt})]})]},r.id))})})]},t)}),!x.length&&e.jsx(h,{children:e.jsx(j,{className:"py-10",children:e.jsx("div",{className:"text-sm text-gray-500",children:"No data available."})})})]})]})}export{V as default};
